classDiagram

    class GameController {
        -List<Player> players
        -Board board
        -Dice dice
        -GameStateManager stateManager
        +StartGame()
        +NextTurn()
        +MovePiece(Player, Piece, int)
        -CanExitBase(Player, Piece) bool
        -CanCapture(Piece, Tile) bool
        -IsSafeZone(Tile) bool
        -CheckWin(Player) bool
        +event PieceMovedHandler OnPieceMoved
        +event PlayerWinHandler OnPlayerWin
    }

    class Player {
        -string Name
        -Color Color
        -List<Piece> Pieces
    }

    class Piece {
        -Player Owner
        -Tile CurrentTile
        -bool IsAtBase
        -bool IsInHome
        +MoveTo(Tile)
        +ResetToBase()
    }

    %% List tiles
    class Board { 
        -List<Tile> Tiles
        +GetStartTile(Player) Player
        +GetNextTile(Piece, int) Tile
        +GetHomePath(Player) List<Tile>
    }

    class Tile {
        -int Position 
        -bool IsSafeZone
        -Color? TileColor 
        -List<Piece> PiecesOnTile
    }

    class Dice {
        +Roll() int
        +event DiceRolledHandler OnDiceRolled
    }

    class GameStateManager {
        -IGameState CurrentState
        +ChangeState(IGameState newState)
    }

    class IGameState {
        <<interface>>
        +Enter()
        +Execute()
        +Exit()
    }

    class DiceRolledHandler {
    <<delegate>>
    +void(int result)
    }

    class PieceMovedHandler {
        <<delegate>>
        +void(Piece piece, Tile newTile)
    }

    class PlayerWinHandler {
        <<delegate>>
        +void(Player winner)
    }

    GameController "1" o-- "2..4" Player : manages
    GameController "1" *-- "1" Board : has
    GameController "1" *-- "1" Dice : uses
    GameController "1" *-- "1" GameStateManager : controls
    
    Player "1" *-- "4" Piece : owns
    Board "1" *-- "*" Tile : contains
    Piece "*" -- "0..1" Tile : located_on
    GameStateManager "1" --> "1" IGameState : currentState